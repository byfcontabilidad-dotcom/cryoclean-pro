<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryoClean Pro - Limpieza Industrial Ecol√≥gica</title>
    <style>
        /* (Se mantienen tus estilos CSS originales) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #10b981; --secondary: #3b82f6; --dark: #1e293b;
            --gray: #64748b; --success: #10b981; --whatsapp: #25D366; --bitcoin: #f7931a;
        }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 50%, #dcfce7 100%); min-height: 100vh; color: var(--dark); }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .whatsapp-float { position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px; background: var(--whatsapp); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 9999; box-shadow: 0 4px 20px rgba(37,211,102,0.4); }
        .whatsapp-float svg { width: 35px; height: 35px; fill: white; }
        .cart-badge { position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; width: 22px; height: 22px; border-radius: 50%; display: none; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
        header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 20px 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        nav { display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        .logo { display: flex; align-items: center; gap: 12px; font-size: 28px; font-weight: bold; color: var(--primary); }
        .nav-links { display: flex; gap: 30px; align-items: center; }
        .btn { padding: 12px 28px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 15px; }
        .btn-primary { background: linear-gradient(135deg, var(--primary), #22c55e); color: white; }
        .btn-secondary { background: white; color: var(--primary); border: 2px solid var(--primary); }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .hero { background: white; border-radius: 24px; padding: 80px 60px; margin: 40px 0; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.08); }
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 35px; margin: 40px 0; }
        .service-card { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); transition: all 0.4s; }
        .service-card:hover { transform: translateY(-15px); }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 24px; padding: 45px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; margin-bottom: 10px; font-weight: 600; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 10px; }
        .payment-method { border: 3px solid #e2e8f0; border-radius: 12px; padding: 20px; margin-bottom: 15px; cursor: pointer; display: flex; align-items: center; gap: 15px; }
        .payment-method.selected { border-color: var(--primary); background: rgba(16, 185, 129, 0.1); }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #f8fafc; border-radius: 12px; margin-bottom: 10px; }
        .firebase-status { position: fixed; top: 80px; right: 20px; background: white; padding: 10px 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); z-index: 1001; }
    </style>
</head>
<body>

    <div id="firebaseStatus" class="firebase-status">
        <span id="statusText">Conectando...</span>
    </div>

    <div class="whatsapp-float" onclick="window.open('https://wa.me/593900000000', '_blank')">
        <svg viewBox="0 0 32 32"><path d="M16 0c-8.837 0-16 7.163-16 16 0 2.825 0.737 5.607 2.137 8.048l-2.137 7.952 7.933-2.127c2.42 1.37 5.173 2.127 8.067 2.127 8.837 0 16-7.163 16-16s-7.163-16-16-16z"/></svg>
    </div>

    <header>
        <nav>
            <div class="logo"><span>‚ùÑÔ∏è</span> CryoClean Pro</div>
            <div class="nav-links">
                <a onclick="document.getElementById('servicios').scrollIntoView()">Servicios</a>
                <button class="btn btn-primary" id="btnCart" style="position: relative;">
                    Carrito <span class="cart-badge" id="cartBadge">0</span>
                </button>
                <button class="btn btn-secondary" id="btnLogin">Admin</button>
            </div>
        </nav>
    </header>

    <div class="container" id="mainContent">
        <section class="hero">
            <h1>Limpieza Industrial Ecol√≥gica</h1>
            <p>Ecuador - Tecnolog√≠a de Hielo Seco y L√°ser</p>
            <button class="btn btn-primary" onclick="document.getElementById('servicios').scrollIntoView()">Ver Cat√°logo</button>
        </section>

        <section id="servicios">
            <h2 style="text-align:center; margin-bottom:30px;">Nuestros Servicios</h2>
            <div class="services-grid" id="servicesContainer"></div>
        </section>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content">
            <h2>Tu Carrito</h2>
            <div id="cartItems"></div>
            <div id="cartTotal" style="font-size:24px; font-weight:bold; margin: 20px 0; text-align:right;">Total: $0.00</div>
            <button class="btn btn-success" id="btnProceedBooking" style="width:100%">Agendar Cita</button>
            <button class="btn btn-secondary" onclick="closeModal('cartModal')" style="width:100%; margin-top:10px;">Cerrar</button>
        </div>
    </div>

    <div id="appointmentModal" class="modal">
        <div class="modal-content">
            <h2>Finalizar Reserva</h2>
            <form id="appointmentForm">
                <div class="form-group"><label>Nombre</label><input type="text" id="apptName" required></div>
                <div class="form-group"><label>Email</label><input type="email" id="apptEmail" required></div>
                <div class="form-group"><label>M√©todo de Pago</label>
                    <div class="payment-method" data-pay="transferencia">üè¶ Transferencia</div>
                    <div class="payment-method" data-pay="btc">‚Çø Bitcoin</div>
                </div>
                <button type="submit" class="btn btn-primary" style="width:100%">Confirmar Pedido</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBsPssHAMzBzYrHvdMFqtR31n2E55ovr8A",
            authDomain: "cryocleanpro.firebaseapp.com",
            projectId: "cryocleanpro",
            storageBucket: "cryocleanpro.firebasestorage.app",
            messagingSenderId: "835260147208",
            appId: "1:835260147208:web:6cfd00fc634ded777353bd"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let cart = [];
        let selectedPaymentMethod = null;

        // Cargar Servicios
        function loadServices() {
            db.collection('servicios').get().then((snapshot) => {
                const container = document.getElementById('servicesContainer');
                let html = '';
                snapshot.forEach(doc => {
                    const s = doc.data();
                    html += `
                        <div class="service-card">
                            <div style="font-size:40px">${s.icon || 'üõ†Ô∏è'}</div>
                            <h3>${s.name}</h3>
                            <p>${s.description}</p>
                            <div style="color:var(--primary); font-size:24px; margin:15px 0">$${Number(s.price).toFixed(2)}</div>
                            <button class="btn btn-primary" onclick="addToCart('${doc.id}', '${s.name}', ${s.price})">A√±adir</button>
                        </div>`;
                });
                container.innerHTML = html;
                document.getElementById('statusText').innerText = "Conectado";
            }).catch(err => {
                console.error(err);
                document.getElementById('statusText').innerText = "Modo Offline";
            });
        }

        function addToCart(id, name, price) {
            cart.push({ id, name, price });
            updateCartUI();
            alert(`${name} a√±adido al carrito`);
        }

        function updateCartUI() {
            const badge = document.getElementById('cartBadge');
            badge.innerText = cart.length;
            badge.style.display = cart.length > 0 ? 'flex' : 'none';

            const itemsDiv = document.getElementById('cartItems');
            let total = 0;
            itemsDiv.innerHTML = cart.map((item, index) => {
                total += item.price;
                return `<div class="cart-item">
                            <span>${item.name}</span>
                            <span>$${item.price.toFixed(2)}</span>
                            <button onclick="removeItem(${index})">‚ùå</button>
                        </div>`;
            }).join('');
            document.getElementById('cartTotal').innerText = `Total: $${total.toFixed(2)}`;
        }

        function removeItem(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        // Modales
        document.getElementById('btnCart').onclick = () => document.getElementById('cartModal').classList.add('active');
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }

        document.getElementById('btnProceedBooking').onclick = () => {
            if (cart.length === 0) return alert("El carrito est√° vac√≠o");
            closeModal('cartModal');
            document.getElementById('appointmentModal').classList.add('active');
        };

        // Selecci√≥n de pago
        document.querySelectorAll('.payment-method').forEach(el => {
            el.onclick = function() {
                document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
                this.classList.add('selected');
                selectedPaymentMethod = this.dataset.pay;
            };
        });

        // Enviar Cita
        document.getElementById('appointmentForm').onsubmit = function(e) {
            e.preventDefault();
            if (!selectedPaymentMethod) return alert("Selecciona un m√©todo de pago");

            const appointment = {
                customer: document.getElementById('apptName').value,
                email: document.getElementById('apptEmail').value,
                items: cart,
                payment: selectedPaymentMethod,
                date: new Date()
            };

            db.collection('citas').add(appointment).then(() => {
                alert("¬°Cita agendada correctamente!");
                cart = [];
                updateCartUI();
                closeModal('appointmentModal');
            }).catch(err => alert("Error al guardar: " + err.message));
        };

        window.onload = loadServices;
    </script>
</body>
</html>
